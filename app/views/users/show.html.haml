.user
  .container
    .left.pull-left
      - if @user.gravatar_id
        .circle
          %img{src: "https://gravatar.com/avatar/#{@user.gravatar_id}?s=192.png"}
      - if @user.location
        %p.text-center= @user.location

      - if @user.projects.count > 0
        %h4.section-heading Projects
        .ul.list-group.project-nav
          - @user.projects.each do |project|
            %li.list-group-item
              %a{href: "##{project.name}"}= project.formatted_name

      - if @user.skills
        %h4.section-heading Skills
        .ul.list-group.skills
          - @user.skills.sort.each do |skill|
            %li.list-group-item= skill
    .right
      - if @user.name
        %h1= @user.name
      - if @user.bio
        %p.bio= @user.bio

      %h3.resume-heading Resume

      - if @user.jobs.count > 0
        %h4.section-heading Work experience
        .box.jobs
          - @user.jobs.each do |job|
            .job
              %h4.company= job.company
              .job-inner
                .job-left
                  %p.title= job.title
                  - date_string = job.end_date ? "From #{format_date(job.start_date)} to #{format_date(job.end_date)}" : "Since #{format_date(job.start_date)}"
                  %p.dates= date_string
                .job-right
                  %p.description= job.description
                %br/

      %h3.portfolio-heading Portfolio

      - if @user.projects.count > 0
        - @user.projects.each do |project|
          %h4.section-heading{id: project.name}= project.formatted_name
          .box.project{"data-repo-user" => @user.github_id, "data-repo-name" => project.name}
            .labels
              %strong Description
              - if project.languages.count > 0
                %strong Languages
              %strong Repository
              - if project.site_url
                %strong Website
            .values
              %p= project.description
              - if project.languages.count > 0
                - total_bytes = project.languages.reduce(0) { |memo, lang| memo += lang.bytes }
                - langs_percs = project.languages.map { |lang| (lang.bytes * 100) / total_bytes }
                - langs_str = ""
                - project.languages.each_with_index { |lang, idx| langs_str += (idx == 0 ? "" : ", ") + "#{langs_percs[idx]}% #{lang.name}" }
                %p= langs_str
              %a{href: project.repo_url}= project.repo_url
              - if project.site_url
                %a{href: project.site_url}= project.site_url